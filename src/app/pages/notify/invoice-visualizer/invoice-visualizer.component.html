<!-- Cierre al hacer click fuera -->
<div class="overlay" (click)="cancel()"></div>

<div class="sheet" role="dialog" aria-modal="true">
    <header class="sheet__header">
        <h3>Editar Factura: {{ filename() }}</h3>
        <button class="icon-btn" (click)="cancel()" aria-label="Cerrar">âœ•</button>
    </header>

    <div class="sheet__body">
        <!-- Visor PDF desde row.url -->
        <div class="pdf" *ngIf="row?.url as pdfUrl; else noPdf">
            <object [attr.data]="pdfUrl" type="application/pdf" width="100%" height="100%">
                <iframe [src]="pdfUrl" title="PDF" width="100%" height="100%"></iframe>
            </object>
        </div>
        <ng-template #noPdf>
            <div class="pdf pdf--placeholder">
                <span>Sin previsualizaciÃ³n de PDF</span>
            </div>
        </ng-template>

        <!-- Formulario reactivo -->
        <form class="form" [formGroup]="form" (ngSubmit)="save()">
            <h4>Datos de la Factura</h4>

            <label>
                NÃºmero de Factura
                <input formControlName="numero_factura" placeholder="Ej: F-2025-001" />
            </label>

            <label>
                Fecha de Factura
                <input type="date" formControlName="fecha" />
            </label>

            <label>
                Nombre del Proveedor
                <input formControlName="nombre_proveedor" placeholder="Nombre de la empresa" />
            </label>

            <label>
                NIF/CIF Proveedor
                <input formControlName="nif_emision" placeholder="Ej: B12345678" />
            </label>

            <label>
                Subtotal (â‚¬)
                <input type="number" step="0.01" formControlName="base1" />
            </label>

            <label>
                IVA (â‚¬)
                <input type="number" step="0.01" formControlName="iva1" />
            </label>

            <label>
                Total (â‚¬)
                <input type="number" step="0.01" formControlName="importe_total" />
            </label>

            <label class="row-inline">
                <input type="checkbox" formControlName="valid" />
                <span>Marcar como Correcta</span>
            </label>

            <div class="actions">
                <button class="btn" type="button" (click)="cancel()">Cancelar</button>
                <button class="btn btn--primary" type="submit">ðŸ’¾ Guardar y Enviar</button>
            </div>
        </form>
    </div>
</div>